# Extract_Conserved_from_Aligned

**My collection of Python scripts to handle extracting conserved patches from aligned sequences. The main impetus was that indentifying these would help in designing primers for PCR amplification.**

---

**Description of each script**


---


- extract_conserved_from_alignments.py

>  aligned sequences in fasta form --> file of sequences that are 100% conserved  
`extract_conserved_from_alignments.py` extracts conserved patches from aligned sequences.  
The main impetus was that identifying these would help in designing primers for PCR amplification.
Developed in collaboration with Damian Menning, who developed the original implementation. See Mon, 14 Dec 2015 post to the Biopython Mailing List and [this gist](https://gist.github.com/fomightez/abd953068a675f416ed3). I note that a variant version of this script is documented [here](https://my.usgs.gov/bitbucket/projects/ASC/repos/python-scripts-for-bioinformatics/browse/findPrimers.py?at=f41f74e848abf264c3f9f2116beb677b56fc8cb7) on the USGS's bitbucket for the Alaska Science Center: Python Scripts for Bioinformatics as `findPrimers.py`.

**Usage**  

* Requires a text of previously aligned sequences in FASTA format. There are a number of resouces that can produce this, for example, the [Multiple Sequence Alignment Tools of EMBL-EBI](http://www.ebi.ac.uk/Tools/msa/).  
Place the alignment file in a directory along with this script.

* As the options are hard-coded into this script for now. You need to edit the script to reflect your alignment file and the minimum cut-off of length for reporting of an extracted sequence. See `USER ADJUSTABLE VALUES` and edit these two values to reflect your.

    * `file_name`
    * `minimum_length_of_consensus_block`

* Then you can invoke the script

    python extract_conserved_from_alignments.py  

  
  
  
**Example of input and output for `extract_conserved_from_alignments.py`:**

**original input:**  

(sequences as text in FASTA format in a file; in example, file is named `test_align.fa.` Contents below.)  
```
>gi|357578918|gb|JN739583.1|_Dilospomenia_genircus_strain_TCC717_18S_ribosomal_RNA_gene_partial_sequence
TGAAACTGCGAATGGCTCATTATATCAGTTATAGTTTATTTGATAGTCCCTTACTACTTGGATAACCGTAGTAATTCTAGAGCTAATACTTGCATAAATATCCCTTCAAGGATAGTATTTATTAGATTTAAACCAACCCCTTAGGGGTGATGTGGTGATTCAAAATAAGTTTACGGATCGCATGGCTTTGCCGGCGACGGATCATTCAAGTTTCTGCCCTATCAGCTTTGGATGGTAGGGTATTGGCCTACCATGGCTTTAACGGGTAACGGAGGATTAGGGTTTGATTCCGGAGAGGGAGCCTGAGAGACGGCTACCACATCCAAGGAAGGCAGCACCCGCGTAAATTACCCAATCCTGACACAGGGAGGTAGTAACAATAAATAACAATGCCGAGCCCTTGTGGTTTGGCACTTGGAATGAGAACAACTCAAACCACTTAACGAGGATCAATTGGAGGGCAAGTCTGGTGCCAGCAGCCGCGGTAATTCCAGCTCCAATAGCGTATATTAAAGTTGTTGCAGTTAAAAAGCTCGTAGTTGGATTTGTGATGGAATTTGAATAC--TTTTAAAGTGTTTCAGAAACTGTCATCTGTGGGTGGAATTTGTTTGGCATTAGGTTGTCAGGCAGAGGATGCCTATCCTTTACTGTGAAAAAATCAGTGCGTTCAAAGCAGACTTACGTCGATGAATGTATTAGCATGGAATAATAAGATAGGACCTTTGTACTATTTTGTTGGTTTGTGTATAGAGGTAATGATTAAAAGGAACAGTTGCCCGTATTTGTATTCCATTGTCAGAGGTGAAATTCTTGGATTTTTGGAAGACAAACTACTGCGAAAGCATTTACCAAGGATGTTTTCATTAATCAAGAACGAAAGTTAGGGGATCGAAGATGATTAGATACCATCGTAGTCTTAACCATAAACTATGCCAACAAGGGATTGGTGGGGTTTCGTAATGTCCCCATCAGCACCTTAGGAGAAATCAAAAGTTTTTGGGTTCCGGGGGGAGTATGGTCGCAAGGCTGAAACTTAAAGAAATTGACGGAAGGGCACCACCAGGAGTGGAGCCTGCGGCTTAATTTGACTCAACACGGGGAAACTTACCAGGTCCAGACATAGTGAGG-ATTGACAGATTGAGAGCTCTTTCTTGATTCTATGGGTGGTGGTGCATGGCCGTTCTTAGTTGGTTTAGTGATTTGTCTGGTTAATTCCGTTAACGAACGAGACCGCTGCCTGCTAAATAGACTAGTTAGTGATTTTCACTGATCAGGTCTTCTTAGAGGGACGTGCATTTTATTAGATGCAGGAAGATAGCGGCAATAACAGGTCTGTGATGCCCTTAGATGATCTGGGCCGCACGCGCGCTACACTGATGTACTCAACGAGTTTTTCCTTGGCTGA-GAAGCCTGGGTAATCTTTTAAACTTGCATCGTGATAGGGATAGATTATTGCAATTATTAATCTTGAACGAGGAATTCCTAGTAAACGCAGATCATCAGTCTGCATTGATTACGTCCCTGCCCTTTGTACACACC
>gi|729922027|gb|KJ52457.1|_Dilospomenia_genircus_strain_B30_18S_ribosomal_RNA_gene_partial_sequence
TGAAACTGCGAATGGCTCATTATATCAGTTATAGTTTATTTGATAGTCCCTTACTACTTGGATAACCGTAGTAATTCTAGAGCTAATACTTGCATAAATATCCCTTCAAGGATAGTATTTATTAGATTGAAACCAACCCCTTCGGGGTGATGTGGTGATTCAAAATAAGTTTACGGATCGCATGGCTTTGCCGGCGACGGATCATTCAAGTTTCTGCCCTATCAGCTTTGGATGGTAGGGTATTGGCCTACCATGGCTTTAACGGGTAACGGAGGATTAGGGTTTGATTCCGGAGAGGGAGCCTGAGAGACGGCTACCACATCCAAGGAAGGCAGCAGGCGCGTAAATTACCCAATCCTGACACAGGGAGGTAGTGACAATAAATAACAATGCCGAGCCCTTGTGGTTTGGCTTTTGGAATGAGAACAACTCAAACCACTTAACGAGGATCAATTGGAGGGCAAGTCTGGTGCCAGCAGCCGCGGTAATTCCAGCTCCAATAGCGTATATTAAAGTTGTTGCAGTTATATAGCTCGTAGTTGGATTTGTGATGGAATTTGAATAC--TTTTAAAGTGTTTCAGAAACTGTCATCTGTGGGTGGAATTTGTTTGGCATTAGGTTGTCAGGCAAAGGATGCCTATCCTTTACTGTGAAAAAATCAGTGCGTTCAAAGCAGACTTATGTCGATGAATGTATTAGCATGGAATAATAAGATAGGACCTTTGTACTATTTTGTTGGTTTGTGTATAGAGGTAATGATTAAAAGGAACAGTTGGGGGTATTTGTATTCCATTGTCAGAGGTGAAATTCTTGGATGGTTGGAAGACAAACTACTGCGAAAGCATTTACCAAGGATGTTTTCATTAATCAAGAACGAAAGTTAGGGGATCGAAGATGATTAGATACCATCGTAGTCTTAACCATAAACTATGCCAACAAGGGATTGGTGGGGTTTCGTAATGTCCCCATCAGCACCTTATGAGAAATCAAAAGTTTTTGGGTTCCGGGGGGAGTATGGTCAAAAGGCTGAAACTTAAAGAAATTGACGGAAGGGCACCACCAGGAGTGGAGCCTGCGGCTTAATTTGACTCAACACGGGGAAACTTACCAGGTCCAGACATAGTGAGG-ATTGACAGATTGAGAGCTCTTTCTTGATTCTATGGGTGGTGGTGCATGGCCGTTCTTAGTTGGTGGAGTGATTTGTCTGGTTAATTCCGTTAACGAACGAGACCGCTGGGTGCTAAATAGACTAGTTAGTGATTTTCACTGATCAGGTCTTCTTAGAGGGACGTGCATTTTATTAGATGCAGGAAGATAGCGGCAATAACAGGTCTGTGATGCCCTTAGATGATCTGGGCCGCACGCGCGCTACACTGATGTATTCAACGAGTTTTTCCTTGGCTGA-GAAGCCTGGGTAATCTTTTAAACTTGCATCGTGATAGGGATAGATTATTGCAATTATTAATCTTGAACGAGGAATTCCTAGTAAACGCAGATCATCAGTCTGCATTGATTACGTCCCTGCCCTTTGTACACACC
>gi|7252965346|gb|KJ678234.1|_Dilospomenia_genircus_strain_CZ018_18S_ribosomal_RNA_gene_partial_sequence
TGAAACTGCGAATGGCTCATTATATCAGTTATAGTTTATTTGATAGTCCCTTACTACTTGGATAACCGTAGTAATTCTAGAGCTAATACTTGCATAAATATCCCTTCAAGGATAGTATTTATTAGATTTAAACCAACCCCTTCGCCCTGATGTGGTGATTCAAAATAAGTTTACGGATCGCATGGCTTTGCCGGCGACGGATCATTCAAGTTTCTGCCCTATCAGCTTTGGATGGTAGGGTATTGGCCTACCATGGCTTTAACGGGTAACGGAGGATTAGGGTTTGATTCCGGAGAGGGAGCCTGAGAGACGGCTACCACATCCAAGGAAGGCAGCAGGCGCGTAAATTACCCAATCCTGACACAGGGAGGTAGTGACAATAAATAACAATGCCGAGCCCTTGTGGTTTGGCACTTGGAATGAGAACAACTCAAACCACTTAACGAGGATCAATTGGAGGGCAAGTCTGGTGCCAGCAGCCGCGGTAATTCCAGCTCCAATAGCGTATAATAAAGTTGTTGCAGTTAAAAAGCTCGTAGTTGGATTTGTGATGGAATTTGAATAC--TTTTAAAGTGTTTCAGAAACTGTCATCTGTGGGTGGAATTTGTTTGGCATTAGGTTGTCAGACAGAGGATGCCTATCCTTTACTGTGAAAAAATCAGTGCGTTCAAAGCAGACTTACGTCGATGAATGTATTAGCATGGAATAATAAGATAGGACCTTTGTACTATTTTGTTGGTTTGTGTATAGAGGTAATGATTAAAACCCACAGTTGGGGGTATTTGTATTCCATTGTCAGAGGTGAAATTCTTGGATTTTTGGAAGACAAACTACTGCGAAAGCATTTACCAAGGATGTTTTCATTAATCAAGAACGAAAGTTAGGGGATCGAAGATGATTAGATACCATCGTAGTCTTAACCATAAACTATGCCAACAAGGGATTGGTGGGGTTTCGTAATGTCCCCATCAGCACCTTAGGAGAAATCAAAAGTTTTTGGGTTCCGGGGGGAGTATGGTCGCAAGGCTGAAACTTAAAGAAATTGACGGAAGGGCACCACCAGGAGTGGAGCCTGCGGCTTAATTTGACTCAACACGGGGAAACTTACCAGGTCCAGACATAGTGAGG-ATTGACAGATTGAGAGCTCTTTCTTGATTCTATGGGTGGTGGTGCATGGCCGTTCTTAGTTGGTGGAGTGATTTGTCTGGTTAATTCCGTTAACGAACGAGACCGCTGCCTGCATGATAGACTAGTTAGTGATTTTCACTGATCAGGTCTTCTTAGAGGGACGTGCATTTTATTAGATGCAGGAAGATAGCGGCAATAACAGGTCTGTGATGCCCTTAGATGATCTGGGCCGCACGCGCGCTACACTGATGTACTCAACGAGTTTTTCCTTGGCTGA-GAAGCCTGGGTAATCTTTTAAACTTGCATCGTGATAGGGATAGATTATTGCAATTATTAATCTTGAACGAGGAATTCCTAGTAAACGCAGATCATCAGTCTGCATTGATTACGTCCCTGCCCTTTGTACACACC
```

**command:**

    python python extract_conserved_from_alignments.py   

**output after run:**  

(text in a file, called `test_align_conserved_20bps.fa`, with the contents below)
```
TGAAACTGCGAATGGCTCATTATATCAGTTATAGTTTATTTGATAGTCCCTTACTACTTGGATAACCGTAGTAATTCTAGAGCTAATACTTGCATAAATATCCCTTCAAGGATAGTATTTATTAGATT
TGATGTGGTGATTCAAAATAAGTTTACGGATCGCATGGCTTTGCCGGCGACGGATCATTCAAGTTTCTGCCCTATCAGCTTTGGATGGTAGGGTATTGGCCTACCATGGCTTTAACGGGTAACGGAGGATTAGGGTTTGATTCCGGAGAGGGAGCCTGAGAGACGGCTACCACATCCAAGGAAGGCAGCA
CGCGTAAATTACCCAATCCTGACACAGGGAGGTAGT
ACAATAAATAACAATGCCGAGCCCTTGTGGTTTGGC
TTGGAATGAGAACAACTCAAACCACTTAACGAGGATCAATTGGAGGGCAAGTCTGGTGCCAGCAGCCGCGGTAATTCCAGCTCCAATAGCGTATA
AGCTCGTAGTTGGATTTGTGATGGAATTTGAATAC--TTTTAAAGTGTTTCAGAAACTGTCATCTGTGGGTGGAATTTGTTTGGCATTAGGTTGTCAG
AGGATGCCTATCCTTTACTGTGAAAAAATCAGTGCGTTCAAAGCAGACTTA
GTCGATGAATGTATTAGCATGGAATAATAAGATAGGACCTTTGTACTATTTTGTTGGTTTGTGTATAGAGGTAATGATTAAAA
GTATTTGTATTCCATTGTCAGAGGTGAAATTCTTGGAT
TTGGAAGACAAACTACTGCGAAAGCATTTACCAAGGATGTTTTCATTAATCAAGAACGAAAGTTAGGGGATCGAAGATGATTAGATACCATCGTAGTCTTAACCATAAACTATGCCAACAAGGGATTGGTGGGGTTTCGTAATGTCCCCATCAGCACCTTA
GAGAAATCAAAAGTTTTTGGGTTCCGGGGGGAGTATGGTC
AAGGCTGAAACTTAAAGAAATTGACGGAAGGGCACCACCAGGAGTGGAGCCTGCGGCTTAATTTGACTCAACACGGGGAAACTTACCAGGTCCAGACATAGTGAGG-ATTGACAGATTGAGAGCTCTTTCTTGATTCTATGGGTGGTGGTGCATGGCCGTTCTTAGTTGGT
AGTGATTTGTCTGGTTAATTCCGTTAACGAACGAGACCGCTG
ATAGACTAGTTAGTGATTTTCACTGATCAGGTCTTCTTAGAGGGACGTGCATTTTATTAGATGCAGGAAGATAGCGGCAATAACAGGTCTGTGATGCCCTTAGATGATCTGGGCCGCACGCGCGCTACACTGATGTA

```
text shown on the command line (specifically, stderr) during script run:
```
Reading in your file...
Concluded.
A file named 'test_align_conserved_20bps.fa' was saved with the results
in same directory as the input file.
Consensus sequence =
TGAAACTGCGAATGGCTCATTATATCAGTTATAGTTTATTTGATAGTCCCTTACTACTTGGATAACCGTAGTAATTCTAGAGCTAATACTTGCATAAATATCCCTTCAAGGATAGTATTTATTAGATT AAACCAACCCCTT G   TGATGT
GGTGATTCAAAATAAGTTTACGGATCGCATGGCTTTGCCGGCGACGGATCATTCAAGTTTCTGCCCTATCAGCTTTGGATGGTAGGGTATTGGCCTACCATGGCTTTAACGGGTAACGGAGGATTAGGGTTTGATTCCGGAGAGGGAGCCTGA
GAGACGGCTACCACATCCAAGGAAGGCAGCA  CGCGTAAATTACCCAATCCTGACACAGGGAGGTAGT ACAATAAATAACAATGCCGAGCCCTTGTGGTTTGGC  TTGGAATGAGAACAACTCAAACCACTTAACGAGGATCAATTGGAG
GGCAAGTCTGGTGCCAGCAGCCGCGGTAATTCCAGCTCCAATAGCGTATA TAAAGTTGTTGCAGTTA A AGCTCGTAGTTGGATTTGTGATGGAATTTGAATAC--TTTTAAAGTGTTTCAGAAACTGTCATCTGTGGGTGGAATTTGTTT
GGCATTAGGTTGTCAG CA AGGATGCCTATCCTTTACTGTGAAAAAATCAGTGCGTTCAAAGCAGACTTA GTCGATGAATGTATTAGCATGGAATAATAAGATAGGACCTTTGTACTATTTTGTTGGTTTGTGTATAGAGGTAATGATTAA
AA   ACAGTTG   GTATTTGTATTCCATTGTCAGAGGTGAAATTCTTGGAT  TTGGAAGACAAACTACTGCGAAAGCATTTACCAAGGATGTTTTCATTAATCAAGAACGAAAGTTAGGGGATCGAAGATGATTAGATACCATCGTAGTC
TTAACCATAAACTATGCCAACAAGGGATTGGTGGGGTTTCGTAATGTCCCCATCAGCACCTTA GAGAAATCAAAAGTTTTTGGGTTCCGGGGGGAGTATGGTC  AAGGCTGAAACTTAAAGAAATTGACGGAAGGGCACCACCAGGAGTGG
AGCCTGCGGCTTAATTTGACTCAACACGGGGAAACTTACCAGGTCCAGACATAGTGAGG-ATTGACAGATTGAGAGCTCTTTCTTGATTCTATGGGTGGTGGTGCATGGCCGTTCTTAGTTGGT  AGTGATTTGTCTGGTTAATTCCGTTAA
CGAACGAGACCGCTG  TGC   ATAGACTAGTTAGTGATTTTCACTGATCAGGTCTTCTTAGAGGGACGTGCATTTTATTAGATGCAGGAAGATAGCGGCAATAACAGGTCTGTGATGCCCTTAGATGATCTGGGCCGCACGCGCGCTACAC
TGATGTA TCAACGAGTTTTTCCTTGGCTGA-GAAGCCTGGGTAATCTTTTAAACTTGCATCGTGATAGGGATAGATTATTGCAATTATTAATCTTGAACGAGGAATTCCTAGTAAACGCAGATCATCAGTCTGCATTGATTACGTCCCTGCC
CTTTGTACACACC.
```

---
